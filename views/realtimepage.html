<!DOCTYPE html>
<html>
<head>
	<title>REALTIME DATA</title>
  <meta charset="UTF-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" type="text/css" href="realtimepage.css" >
  <script>
    var socket = io();
    var currentUser;
    $(document).ready(function(){
      socket.emit('userWho');
      socket.on('userIs', function(user){
        currentUser = user;
        $('#currentUser').html(currentUser+'님 농장');
      });
      const onOffString = ['OFF', 'ON'];
      const modeString = ['자동', '수동'];

      socket.on('house1Msg', function(data){
        console.log('House1 msg has arrived.');
        console.log('House1 temp1: '+data.house[0].temp[0]);
        $('#h1t1').html(data.house[0].temp[0]);
        $('#h1t2').html(data.house[0].temp[1]);
        $('#h1t3').html(data.house[0].temp[2]);
        $('#h1t4').html(data.house[0].temp[3]);
        $('#h1t5').html(data.house[0].temp[4]);
        $('#h1t6').html(data.house[0].temp[5]);

        $('#h1h1').html(data.house[0].humid[0]);
        $('#h1h2').html(data.house[0].humid[1]);
        $('#h1h3').html(data.house[0].humid[2]);
        $('#h1h4').html(data.house[0].humid[3]);
        $('#h1h5').html(data.house[0].humid[4]);
        $('#h1h6').html(data.house[0].humid[5]);

        $('#h1avgtemp').html(data.house[0].avgTemp);
        $('#h1avghumid').html(data.house[0].avgHumid);
        $('#h1tartemp').html(data.house[0].tarTemp);
        $('#h1ventilper').html(data.house[0].ventilPer+'%');

        $('#h1fanmode').html(modeString[data.house[0].fanMode]);
        $('#h1humidifiermode').html(modeString[data.house[0].waterMode]);
        
        $('#h1fan1state').html(onOffString[data.house[0].fan[0]]);
        $('#h1fan2state').html(onOffString[data.house[0].fan[1]]);
        $('#h1fan3state').html(onOffString[data.house[0].fan[2]]);
        $('#h1humidifierstate').html(onOffString[data.house[0].water]);
        $('#h1alarm').html(onOffString[data.house[0].alarm]);
        $('#h1farmstate').html(data.house[0].state);


      });
      socket.on('house2Msg', function(data){
        console.log('House2 msg has arrived.');
        console.log(data.house[1].temp[0]);
        $('#h2t1').html(data.house[1].temp[0]);
        $('#h2t2').html(data.house[1].temp[1]);
        $('#h2t3').html(data.house[1].temp[2]);
        $('#h2t4').html(data.house[1].temp[3]);
        $('#h2t5').html(data.house[1].temp[4]);
        $('#h2t6').html(data.house[1].temp[5]);

        $('#h2h1').html(data.house[1].humid[0]);
        $('#h2h2').html(data.house[1].humid[1]);
        $('#h2h3').html(data.house[1].humid[2]);
        $('#h2h4').html(data.house[1].humid[3]);
        $('#h2h5').html(data.house[1].humid[4]);
        $('#h2h6').html(data.house[1].humid[5]);

        $('#h2avgtemp').html(data.house[1].avgTemp);
        $('#h2avghumid').html(data.house[1].avgHumid);
        $('#h2tartemp').html(data.house[1].tarTemp);
        $('#h2ventilper').html(data.house[1].ventilPer);
        $('#h2fanmode').html(modeString[data.house[1].fanMode]);
        $('#h2humidifiermode').html(modeString[data.house[1].waterMode]);

        $('#h2fan1state').html(onOffString[data.house[1].fan[0]]);
        $('#h2fan2state').html(onOffString[data.house[1].fan[1]]);
        $('#h2fan3state').html(onOffString[data.house[1].fan[2]]);
        $('#h2humidifierstate').html(onOffString[data.house[1].water]);
        $('#h2alarm').html(onOffString[data.house[1].alarm]);
        $('#h2farmstate').html(data.house[1].state);
      });
      
    });
  </script>
</head>
<body>	
  <div id="currentUser">
    --
  </div>
  <div class="table-title">
    <h3>HOUSE1</h3>
  </div>
  <table class="table-fill">
    <tr>
      <th class="text-left">온도1</th>
      <th class="text-left">온도2</th>
      <th class="text-left">온도3</th>
      <th class="text-left">온도4</th>
      <th class="text-left">온도5</th>
      <th class="text-left">온도6</th>
    </tr>
    <tr>
      <td id="h1t1" class="text-left">--.-</th>
      <td id="h1t2" class="text-left">--.-</th>
      <td id="h1t3" class="text-left">--.-</th>
      <td id="h1t4" class="text-left">--.-</th>
      <td id="h1t5" class="text-left">--.-</th>
      <td id="h1t6" class="text-left">--.-</th>
    </tr>
    <tr>
      <th class="text-left">습도1</th>
      <th class="text-left">습도2</th>
      <th class="text-left">습도3</th>
      <th class="text-left">습도4</th>
      <th class="text-left">습도5</th>
      <th class="text-left">습도6</th>
    </tr>
    <tr>
      <td id="h1h1" class="text-left">--.-</th>
      <td id="h1h2" class="text-left">--.-</th>
      <td id="h1h3" class="text-left">--.-</th>
      <td id="h1h4" class="text-left">--.-</th>
      <td id="h1h5" class="text-left">--.-</th>
      <td id="h1h6" class="text-left">--.-</th>
    </tr>
    <tr>
      <th class="text-left">평균온도</th>
      <th class="text-left">평균습도</th>
      <th class="text-left">목표온도</th>
      <th class="text-left">환기량</th>
      <th class="text-left">팬모드</th>
      <th class="text-left">가습모드</th>
    </tr>
    <tr>
      <td id="h1avgtemp" class="text-left">--.-</th>
      <td id="h1avghumid" class="text-left">--.-</th>
      <td id="h1tartemp" class="text-left">--.-</th>
      <td id="h1ventilper" class="text-left">--.-%</th>
      <td id="h1fanmode" class="text-left">---</th>
      <td id="h1humidifiermode" class="text-left">---</th>
    </tr>
    <tr>
      <th class="text-left">팬1</th>
      <th class="text-left">팬2</th>
      <th class="text-left">팬3</th>
      <th class="text-left">가습기</th>
      <th class="text-left">알람</th>
      <th class="text-left">상태</th>
    </tr>
    <tr>
      <td id="h1fan1state" class="text-left">---</th>
      <td id="h1fan2state" class="text-left">---</th>
      <td id="h1fan3state" class="text-left">---</th>
      <td id="h1humidifierstate" class="text-left">---</th>
      <td id="h1alarm" class="text-left">---</th>
      <td id="h1farmstate" class="text-left">---</th>
    </tr>
  </table>
  <div class="table-title">
    <h3>HOUSE2</h3>
  </div>>
  <table class="table-fill">
    <tr>
      <th class="text-left">온도1</th>
      <th class="text-left">온도2</th>
      <th class="text-left">온도3</th>
      <th class="text-left">온도4</th>
      <th class="text-left">온도5</th>
      <th class="text-left">온도6</th>
    </tr>
    <tr>
      <td id="h2t1" class="text-left">--.-</th>
      <td id="h2t2" class="text-left">--.-</th>
      <td id="h2t3" class="text-left">--.-</th>
      <td id="h2t4" class="text-left">--.-</th>
      <td id="h2t5" class="text-left">--.-</th>
      <td id="h2t6" class="text-left">--.-</th>
    </tr>
    <tr>
      <th class="text-left">습도1</th>
      <th class="text-left">습도2</th>
      <th class="text-left">습도3</th>
      <th class="text-left">습도4</th>
      <th class="text-left">습도5</th>
      <th class="text-left">습도6</th>
    </tr>
    <tr>
      <td id="h2h1" class="text-left">--.-</th>
      <td id="h2h2" class="text-left">--.-</th>
      <td id="h2h3" class="text-left">--.-</th>
      <td id="h2h4" class="text-left">--.-</th>
      <td id="h2h5" class="text-left">--.-</th>
      <td id="h2h6" class="text-left">--.-</th>
    </tr>
    <tr>
      <th class="text-left">평균온도</th>
      <th class="text-left">평균습도</th>
      <th class="text-left">목표온도</th>
      <th class="text-left">환기량</th>
      <th class="text-left">팬모드</th>
      <th class="text-left">가습모드</th>
    </tr>
    <tr>
      <td id="h2avgtemp" class="text-left">--.-</th>
      <td id="h2avghumid" class="text-left">--.-</th>
      <td id="h2tartemp" class="text-left">--.-</th>
      <td id="h2ventilper" class="text-left">--.-%</th>
      <td id="h2fanmode" class="text-left">---</th>
      <td id="h2humidifiermode" class="text-left">---</th>
    </tr>
    <tr>
      <th class="text-left">팬1</th>
      <th class="text-left">팬2</th>
      <th class="text-left">팬3</th>
      <th class="text-left">가습기</th>
      <th class="text-left">알람</th>
      <th class="text-left">상태</th>
    </tr>
    <tr>
      <td id="h2fan1state" class="text-left">---</th>
      <td id="h2fan2state" class="text-left">---</th>
      <td id="h2fan3state" class="text-left">---</th>
      <td id="h2humidifierstate" class="text-left">---</th>
      <td id="h2alarm" class="text-left">---</th>
      <td id="h2farmstate" class="text-left">---</th>
    </tr>
  </table>
</body>
</html>